input {
  beats {
    port => 5044
  }
}

filter {

  mutate {
    gsub => [
#    'message', '\\', '',    #remove symbols
#    'message', '-', '',     #remove symbols
#    'message', '\s', ',',    #remove spaces and add comma to parsing columns
    'message', '\n', ''    #remove multiline
    ]
  }

  csv {
    separator => ","
    autodetect_column_names => true
    autogenerate_column_names => true        # use only if csv file has some no titled columns
    skip_header => "true"
  }

  mutate {
    add_field => { "recorte" => "%{source}" }
    gsub => [
      'recorte', '/', '',    #remove symbols
      'recorte', '-', '',    #remove symbols
      'recorte', '\s+', ''
    ]
  }

}

output {
  elasticsearch {
      hosts => "elasticsearch1:9200"
      index => "csv-%{recorte}"
  }
}
